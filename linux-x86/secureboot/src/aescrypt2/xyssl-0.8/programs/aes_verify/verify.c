#include <sys/types.h>
#include <unistd.h>

#include <string.h>
#include <stdlib.h>
#include <stdio.h>
#include <time.h>

#include "xyssl/aes.h"
#include "xyssl/des.h"

#define MODE_ENCRYPT    0
#define MODE_DECRYPT    1
#define AES_PROTOCOL    0

/*
unsigned char src[6][16] = { { 0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0xaa,0xbb,0xcc,0xdd,0xee,0xff } ,
							 { 0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x11 } ,
							 { 0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x40 } ,
							 { 0xfe,0xed,0xdc,0xcb,0xba,0xa9,0x98,0x87,0x76,0x65,0x54,0x43,0x32,0x21,0x10,0xed } ,
							 { 0x66,0x67,0x68,0x69,0x6a,0x6b,0x6c,0x6d,0x6e,0x6f,0x70,0x71,0x72,0x73,0x74,0x75 } ,
							 { 0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x90,0x9a,0x9b,0x9c,0x9d,0x9e,0x9f }
						   };

unsigned char ecb_key[16]= { 0xff,0xee,0xdd,0xcc,0xbb,0xaa,0x99,0x88,0x77,0x66,0x55,0x44,0x33,0x22,0x11,0x0f };
unsigned char cbc_key[16]= { 0xfe,0xed,0xdc,0xcb,0xba,0xa9,0x98,0x87,0x76,0x65,0x54,0x43,0x32,0x21,0x10,0x0f }; 
*/

unsigned char ecb_key[16] = { 0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c };
unsigned char src[16]=	{ 0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a };
//unsigned char ecb_encrypted[6][16] ;
unsigned char ecb_encrypted[16];
unsigned char cbc_encrypted[6][16] ;

unsigned char ecb_out[6][16];
unsigned char cbc_out[6][16];

unsigned char cbcIV[16] = { 0x1f,0x2e,0x3d,0x4c,0x5b,0x6a,0x79,0x88,0x97,0xa6,0xb5,0xc4,0xd3,0xe2,0xf1,0xf0 };
unsigned char cbcdecIV[16]={ 0x1f,0x2e,0x3d,0x4c,0x5b,0x6a,0x79,0x88,0x97,0xa6,0xb5,0xc4,0xd3,0xe2,0xf1,0xf0 };
int main( int argc, char *argv[] )


{
	int i =0,j;
	aes_context cbc_ctx;
	aes_context ecb_ctx;
	
	aes_context cbc_dec_ctx;
	aes_context ecb_dec_ctx;
	
	aes_setkey_enc(&ecb_ctx,ecb_key,128);
	
	aes_crypt_ecb(&ecb_ctx,MODE_ENCRYPT,src,ecb_encrypted);
	for ( j=0 ; j < 16; j++)	
	{
		printf(" 0x%02x,",	ecb_encrypted[j]);
			
	}
/*	
	for ( i=0 ; i < 6 ; i++)
	{
		aes_crypt_ecb(&ecb_ctx,MODE_ENCRYPT,src[i],ecb_encrypted[i]);
	}
	
	aes_setkey_enc(&cbc_ctx,cbc_key,128);
	for ( i=0 ; i < 6 ; i++)
	{
		
		aes_crypt_cbc(&cbc_ctx,MODE_ENCRYPT,16,cbcIV,src[i],cbc_encrypted[i]);
	}	
	
	for ( i =0 ; i < 6 ; i++)
	{
		for ( j=0 ; j < 16; j++)	
		{
			printf(" 0x%02x,",	ecb_encrypted[i][j]);
			
		}
		printf("\n");
	}
	for ( i= 0 ; i < 6 ; i++)
	{
		for ( j=0 ; j < 16; j++)	
		{
			printf(" 0x%02x,",	cbc_encrypted[i][j]);
			
		}
		printf("\n");
	}
	
	aes_setkey_dec(&ecb_dec_ctx,ecb_key,128);
	
	for ( i=0 ; i < 6 ; i++)
	{
		aes_crypt_ecb(&ecb_dec_ctx,MODE_DECRYPT,ecb_encrypted[i],ecb_out[i]);
	}
	
	aes_setkey_dec(&cbc_dec_ctx,cbc_key,128);
	for ( i=0 ; i < 6 ; i++)
	{
		
		aes_crypt_cbc(&cbc_dec_ctx,MODE_DECRYPT,16,cbcdecIV,cbc_encrypted[i],cbc_out[i]);
	}
	
	if ( memcmp(src,ecb_out,6*16)==0 && memcmp(src,cbc_out,6*16)==0)
		printf("Success\n");
	else
		printf("Failed\n");	
		
*/		
}
