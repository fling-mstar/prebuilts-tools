
# Also see "include/polarssl/config.h"

#CFLAGS	= -I
OFLAGS	= -O
POLARSSL_DISTDIR = ..

#INC_DIR = \
	-I$(POLARSSL_DISTDIR)/include/polarssl \

LD_LIB_PATH  = \
	-L$(POLARSSL_DISTDIR)/library -lpolarssl\

LDLIB = $(LD_LIB_PATH)

CFLAGS	= -I../include -D_FILE_OFFSET_BITS=64 \
	  -I$(POLARSSL_DISTDIR)/include/polarssl 

# OSX shared library extension:
# DLEXT=dylib
OBJS=  aes.o           arc4.o          base64.o        \
        bignum.o        certs.o         debug.o         \
        des.o           dhm.o           havege.o        \
        md2.o           md4.o           md5.o           \
        net.o           padlock.o       rsa.o           \
        sha1.o          sha2.o          sha4.o          \
        ssl_cli.o       ssl_srv.o       ssl_tls.o       \
        timing.o        x509parse.o     xtea.o          \
        camellia.o      polarssl_api.o  prng.o          \
        base32.o

.SILENT:

all: static pwd_out

main:  
	echo "compile main"
	$(CC) $(CFLAGS) -lm -o GenDataBase.exe main.c $(LDLIB)
	echo  "compile end"

pwd_out:
	echo "PWD_OUT start"
	$(CC) -lm -o PWD_OUT.exe pwd_out_for_production.c $(LDLIB)
	echo "PWD_OUT end"

static: libpolarssl.a

shared: libpolarssl.$(DLEXT)

libpolarssl.a: $(OBJS)
	echo "  AR    $@"
	ar r $@ $(OBJS)
	echo "  RL    $@"
	ranlib $@

libpolarssl.so: libpolarssl.a
	echo "  LD    $@"
	$(CC) -shared -Wl,-soname,$@ -o $@ $(OBJS)

libpolarssl.dylib: libpolarssl.a
	echo "  LD    $@"
	$(CC) -dynamiclib -o $@ $(OBJS)

.c.o:
	echo "  CC    $<"
	$(CC) $(CFLAGS) $(OFLAGS) -c $<

clean:
	rm -f *.o libpolarssl.* GenDataBase.exe

